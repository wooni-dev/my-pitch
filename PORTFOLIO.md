# My Pitch - 포트폴리오 문서

> 음악 파일에서 음정을 자동 분석하여 악보로 변환하는 웹 서비스

🌐 **[My Pitch 바로가기 →](https://my-pitch.work/)** - 배포된 서비스를 직접 사용해보실 수 있습니다.

---

## 📌 프로젝트 개요

### 프로젝트 동기
노래방에서 녹음한 내 음정을 확인하고 싶다는 개인적 필요에서 출발하여, 복잡한 음악 이론 지식 없이도 누구나 자신의 음정을 악보로 시각화하여 확인할 수 있는 서비스를 개발했습니다.

### 핵심 기능
- 🎵 **음원 분리**: Demucs AI 모델을 이용한 보컬/MR 분리
- 🎼 **음정 분석**: Librosa를 이용한 음정 추출
- 📊 **악보 시각화**: VexFlow를 활용한 악보 렌더링
- 🎧 **동기화 재생**: 악보와 오디오 동기화

### 기술 스택

- **Frontend**: Next.js, VexFlow
- **Backend**: Python, Flask, Librosa, Demucs
- **Infrastructure**: Docker, Nginx, MinIO

---

## 🎬 서비스 소개

> 💡 **썸네일을 클릭하면 YouTube에서 영상을 시청할 수 있습니다.**
>
> *※ 저작권 문제로 모든 영상의 음성을 제거했습니다.*

<table>
<tr>
<td width="50%">

### 1. My Pitch 사용법
[![My Pitch 사용법](https://img.youtube.com/vi/IJ230xx4sC8/maxresdefault.jpg)](https://youtu.be/IJ230xx4sC8)

음악 파일 업로드부터 음원 분리, 음정 분석, 악보 변환까지 전체 사용 흐름을 보여줍니다. VexFlow를 활용한 악보 렌더링과 오디오 동기화 재생 기능을 확인할 수 있습니다.

</td>
<td width="50%">

### 2. My Pitch 순번 대기
[![My Pitch 순번 대기](https://img.youtube.com/vi/FFLvpNCe9uM/maxresdefault.jpg)](https://youtu.be/FFLvpNCe9uM)

인메모리 작업 큐 시스템의 동작 방식과 대기열 UX를 보여줍니다. 이벤트 기반 워커를 통한 순차 처리와 사용자에게 실시간으로 대기 순번을 안내하는 방식을 확인할 수 있습니다.

</td>
</tr>
</table>

<table>
<tr>
<td width="50%">

### 3. MinIO 파일 관리
[![MinIO 파일 관리](https://img.youtube.com/vi/J6G-9mkcc1Y/maxresdefault.jpg)](https://youtu.be/J6G-9mkcc1Y)

악보 변환 과정에서 생성되는 원본 파일, 분리된 보컬/MR 파일들을 MinIO 오브젝트 스토리지에서 관리하는 방법을 보여줍니다. Presigned URL을 통한 안전한 파일 접근 방식을 확인할 수 있습니다.

</td>
<td width="50%">

### 4. My Pitch 모바일 사용법
[![My Pitch 모바일 사용법](https://img.youtube.com/vi/dIEL0GkP-BA/maxresdefault.jpg)](https://youtu.be/dIEL0GkP-BA)

모바일 환경에서의 반응형 디자인과 사용자 경험을 보여줍니다. 화면 크기에 따라 자동으로 조정되는 악보 레이아웃과 터치 인터랙션을 확인할 수 있습니다.

</td>
</tr>
</table>

---

## 🏗️ 아키텍처 설계

### 시스템 아키텍처

#### 개발 환경 (외부 서버 사용)
> GPU 없는 로컬 환경에서 외부 Colab 서버로 음원 분리 요청

```
┌─────────────┐
│   Client    │  Next.js (React) - 악보 렌더링 및 오디오 플레이어
│  (Browser)  │  - 3초 폴링으로 작업 상태 조회
└──────┬──────┘
       │ HTTP
┌──────▼──────┐
│    Nginx    │  리버스 프록시, 라우팅
│   (Proxy)   │
└──────┬──────┘
       │
   ┌───┴───────────┬─────────┐
   │               │         │
┌──▼───────────┐ ┌─▼────┐ ┌──▼───────┐
│  Flask API   │ │Client│ │  MinIO   │  오브젝트 스토리지
│              │ │Next  │ │(Storage) │  - 원본 파일만 저장
│ ┌──────────┐ │ └──────┘ └──────────┘
│ │ Job Queue│ │  인메모리 작업 대기열
│ │  (deque) │ │  - 순차 처리
│ │          │ │  - 대기열 제한 (MAX: 3명)
│ │ [Job1]   │ │  - 이벤트 기반 워커
│ │ [Job2]   │ │
│ │ [Job3]   │ │
│ └──────┬───┘ │
└────────┼─────┘
         │ HTTPS
         ▼
┌─────────────────┐
│  Colab Server   │  외부 음원 분리 서버
│  (Demucs GPU)   │  - 보컬/MR 분리
└─────────────────┘  - 분리 파일 반환
```

#### 배포 환경 (로컬 처리)
> GPU 장착 서버에서 로컬 Demucs 모델 직접 실행

```
┌─────────────┐
│   Client    │  Next.js (React) - 악보 렌더링 및 오디오 플레이어
│  (Browser)  │  - 3초 폴링으로 작업 상태 조회
└──────┬──────┘
       │ HTTPS
┌──────▼──────┐
│    Nginx    │  리버스 프록시, 라우팅, HTTPS 처리
│   (Proxy)   │  - Let's Encrypt SSL/TLS
│             │  - Certbot 자동 갱신 (12시간마다 체크)
└──────┬──────┘
       │
   ┌───┴───────────┬─────────┐
   │               │         │
┌──▼───────────┐ ┌─▼────┐ ┌──▼───────┐
│  Flask API   │ │Client│ │  MinIO   │  오브젝트 스토리지
│              │ │Next  │ │(Storage) │  - 원본 파일
│ ┌──────────┐ │ └──────┘ └────▲─────┘  - 분리된 파일
│ │ Job Queue│ │               │
│ │  (deque) │ │  인메모리 작업 대기열          │
│ │          │ │  - 순차 처리                  │
│ │ [Job1]   │ │  - 대기열 제한 (MAX: 3명)     │
│ │ [Job2]   │ │  - 이벤트 기반 워커           │
│ │ [Job3]   │ │                              │
│ └──────┬───┘ │                              │
│        │     │                              │
│  ┌─────▼────┐│                              │
│  │ Demucs AI││  GPU 자동 감지 (CUDA/CPU)     │
│  │(로컬 GPU) ││  - 보컬/MR 분리              │
│  └─────┬────┘│  - MinIO 저장                │
└────────┼─────┘                              │
         └────────────────────────────────────┘
```

### 서비스 플로우

1. **파일 업로드** → 음악 파일을 서버에 업로드하고 대기열에 등록
2. **음원 분리** → AI 모델이 보컬과 반주를 분리
3. **음정 분석** → 분리된 보컬에서 음정 추출
4. **악보 생성** → 추출된 음정을 악보로 시각화
5. **결과 확인** → 오디오 재생과 동기화된 악보 제공